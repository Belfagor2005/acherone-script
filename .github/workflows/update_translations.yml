name: Test Plugin Updaters

on:
  push:
    branches: [main]
  workflow_dispatch:

jobs:
  update-plugins:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Find all plugin updater scripts
        run: |
          echo "Searching for plugin updater scripts..."
          find . -type f -name "update_translations.py" > updater_list.txt
          cat updater_list.txt

      - name: Run all plugin updaters
        run: |
          while IFS= read -r updater; do
            echo "Running $updater..."
            python3 "$updater" || echo "⚠️ $updater failed, continuing..."
          done < updater_list.txt
